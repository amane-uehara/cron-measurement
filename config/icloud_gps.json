{
  "constant": {
    "warning" : "This `constant` block will be over written. Do not edit this file.",

    "hostname"                    : "example_host",
    "icloud_gps_raw_path"         : "/path/to/raw/data/dir",
    "icloud_gps_hourly_path"      : "/path/to/hourly/data/dir",
    "icloud_gps_daily_path"       : "/path/to/daily/data/dir",
    "icloud_gps_drop_files"       : "${icloud_gps_raw_path}/${yyyymmddhh-4}*.json",

    "icloud_gps_cookie_directory" : "/path/to/icloud_login_session",
    "icloud_gps_apple_id"         : "mail.address@mail",
    "icloud_gps_password"         : "aaabbbcccdddd",
    "icloud_gps_device_name"      : "device-name"
  },

  "job_icloud_gps_raw_json": {
    "sensor"           : "icloud_gps",
    "program"          : "fetch_raw_json",
    "extra"            : {
      "device"         : "${icloud_gps_device_name}"
    },
    "apple_id"         : "${icloud_gps_apple_id}",
    "password"         : "${icloud_gps_password}",
    "cookie_directory" : "${icloud_gps_cookie_directory}",
    "output_file"      : "${icloud_gps_raw_path}/${yyyymmddhhmmss}.json"
  },
  "job_icloud_gps_drop": {
    "item"             : "icloud_gps",
    "sensor"           : "shell",
    "program"          : "shell",
    "command_list"     : [
      "ls ${icloud_gps_drop_files} | wc -l",
      "rm -rf ${icloud_gps_drop_files}",
      "ls ${icloud_gps_drop_files} | wc -l"
    ]
  },

  "job_icloud_gps_hourly_cron": {
    "sensor"           : "fork",
    "program"          : "fork",
    "fork_time"        : "${yyyymmddhhmmss}",
    "job_list"         : [
      "job_icloud_gps_gps_hourly_json",
      "job_icloud_gps_gps_hourly_csv"
    ]
  },
  "job_icloud_gps_gps_hourly_json": {
    "sensor"           : "icloud_gps",
    "program"          : "to_json_list",
    "input_file_list"  : ["${icloud_gps_raw_path}/${yyyymmddhh}*.json"],
    "output_file"      : "${icloud_gps_hourly_path}/json/${yyyymmddhh}.json.gz"
  },
  "job_icloud_gps_gps_hourly_csv": {
    "sensor"           : "icloud_gps",
    "program"          : "to_csv",
    "run_key_list"     : ["dt", "hostname", "mac_addr", "extra.device"],
    "input_file_list"  : ["${icloud_gps_hourly_path}/json/${yyyymmddhh}.json.gz"],
    "output_file"      : "${icloud_gps_hourly_path}/csv/${yyyymmddhh}.csv.gz"
  },

  "job_icloud_gps_daily_cron": {
    "sensor"           : "fork",
    "program"          : "fork",
    "fork_time"        : "${yyyymmddhhmmss}",
    "job_list"         : [
      "job_icloud_gps_gps_daily_json",
      "job_icloud_gps_gps_daily_csv"
    ]
  },
  "job_icloud_gps_gps_daily_json": {
    "sensor"           : "icloud_gps",
    "program"          : "to_json_list",
    "input_file_list"  : ["${icloud_gps_hourly_path}/json/${yyyymmdd}*.json.gz"],
    "output_file"      : "${icloud_gps_daily_path}/all_json/${yyyymmdd}.json.gz"
  },
  "job_icloud_gps_gps_daily_csv": {
    "sensor"           : "icloud_gps",
    "program"          : "to_csv",
    "run_key_list"     : ["dt", "hostname", "mac_addr", "extra.device"],
    "input_file_list"  : ["${icloud_gps_daily_path}/all_json/${yyyymmdd}.json.gz"],
    "output_file"      : "${icloud_gps_daily_path}/all_csv/${yyyymmdd}.csv.gz"
  }
}
